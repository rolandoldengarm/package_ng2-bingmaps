{"version":3,"sources":["services/marker-manager.ts"],"names":[],"mappings":"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","file":"services/marker-manager.js","sourcesContent":["import {Injectable, NgZone} from '@angular/core';\r\nimport {Observer} from 'rxjs/Observer';\r\nimport {Observable} from 'rxjs/Observable';\r\nimport {BingMapMarker} from '../directives/bing-map-marker';\r\nimport {BingMapsAPIWrapper} from './bing-maps-api-wrapper';\r\nimport {Marker} from './bing-maps-types';\r\n\r\n@Injectable()\r\nexport class MarkerManager {\r\n  private _markers: Map<BingMapMarker, Promise<Marker>> =\r\n      new Map<BingMapMarker, Promise<Marker>>();\r\n\r\n  constructor(private _mapsWrapper: BingMapsAPIWrapper, private _zone: NgZone) {}\r\n\r\n  deleteMarker(marker: BingMapMarker): Promise<void> {\r\n    const m = this._markers.get(marker);\r\n    if (m == null) {\r\n      // marker already deleted\r\n      return Promise.resolve();\r\n    }\r\n    return m.then((m: Marker) => {\r\n      return this._zone.run(() => {\r\n        m.deleteMarker();\r\n        this._markers.delete(marker);\r\n      });\r\n    });\r\n  }\r\n\r\n  updateMarkerPosition(marker: BingMapMarker): Promise<void> {\r\n    return this._markers.get(marker).then(\r\n        (m: Marker) => m.setPosition({lat: marker.latitude, lng: marker.longitude}));\r\n  }\r\n\r\n  updateTitle(marker: BingMapMarker): Promise<void> {\r\n    return this._markers.get(marker).then((m: Marker) => m.setTitle(marker.title));\r\n  }\r\n\r\n  updateLabel(marker: BingMapMarker): Promise<void> {\r\n    return this._markers.get(marker).then((m: Marker) => { m.setLabel(marker.label); });\r\n  }\r\n\r\n  updateDraggable(marker: BingMapMarker): Promise<void> {\r\n    return this._markers.get(marker).then((m: Marker) => m.setDraggable(marker.draggable));\r\n  }\r\n\r\n  updateIcon(marker: BingMapMarker): Promise<void> {\r\n    return this._markers.get(marker).then((m: Marker) => m.setIcon(marker.iconUrl));\r\n  }\r\n\r\n  addMarker(marker: BingMapMarker) {\r\n    const markerPromise = this._mapsWrapper.createMarker({\r\n      position: {lat: marker.latitude, lng: marker.longitude},\r\n      label: marker.label,\r\n      draggable: marker.draggable,\r\n      icon: marker.iconUrl\r\n    });\r\n    this._markers.set(marker, markerPromise);\r\n  }\r\n\r\n  getNativeMarker(marker: BingMapMarker): Promise<Marker> {\r\n    return this._markers.get(marker);\r\n  }\r\n\r\n  createEventObservable<T>(eventName: string, marker: BingMapMarker): Observable<T> {\r\n    return Observable.create((observer: Observer<T>) => {\r\n      this._markers.get(marker).then((m: Marker) => {\r\n        m.addListener(eventName, (e: T) => this._zone.run(() => observer.next(e)));\r\n      });\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}